<form id="build-a-quote" action="https://go.pardot.com/l/37432/2018-04-06/5gh3kp" method="post">
    <div>
        <input class="form-item__textfield" id="firstName" name="firstName" placeholder="First name" required
            tabindex="1" type="text">
        <input class="form-item__textfield" id="lastName" name="lastName" placeholder="Last name" required tabindex="1"
            type="text">
        <input class="form-item__textfield" id="company" name="company" placeholder="Company" required tabindex="1"
            type="text">
        <input class="form-item__textfield" id="email" name="email" placeholder="Email" required tabindex="1"
            type="email">
        <input class="form-item__textfield" id="Phone" name="Phone" pattern="[0-9]+" placeholder="Phone" required
            tabindex="1" type="number">
        <input class="form-item__textfield" id="zipCode" name="zipCode" pattern="[0-9]+" placeholder="Zip Code" required
            tabindex="1" type="text">
        <button class="button" name="submit" type="submit">Submit</button>
    </div>
</form>
<script>
document.getElementById('build-a-quote').addEventListener('submit', function (event) {
  try {
    // Get tracking values from localStorage
    const utmData = {
      'custom_fields[UTM Source]': localStorage.getItem('utm_source') || '',
      'custom_fields[UTM Medium]': localStorage.getItem('utm_medium') || '',
      'custom_fields[UTM Campaign]': localStorage.getItem('utm_campaign') || '',
      'custom_fields[source_page_url]': localStorage.getItem('source_page_url') || window.location.href,
      'custom_fields[referrer]': localStorage.getItem('referrer') || document.referrer
    };

    // Merge tracking data with form data
    const data = Object.assign({}, {
      'custom_fields[firstName]': jQuery('#firstName').val(),
      'custom_fields[lastName]': jQuery('#lastName').val(),
      'custom_fields[company]': jQuery('#company').val(),
      'custom_fields[email]': jQuery('#email').val(),
      'custom_fields[zipCode]': jQuery('#zipCode').val(),
      'phone_number': jQuery('#Phone').val(),
      'country_code': '1',
      'caller_name': jQuery('#firstName').val() + ' ' + jQuery('#lastName').val()
    }, utmData);

    jQuery.ajax({
      url: 'https://api.calltrackingmetrics.com/api/v1/formreactor/FRT472ABB2C5B9B141ADAB06C7A709212DB5B0EF60229D38F02D4C00D8145FDA58D?key=VLhTUhvwsNBljzFmnVX5bui0GD-PaYcjHGPESzPwHQpCqWeY',
      type: 'POST',
      data: data,
      success: function (response) {
        console.log('Form successfully submitted:', response);
      },
      error: function (xhr, status, error) {
        console.error('Error submitting form:', xhr.responseText);
      }
    });
  } catch (error) {
    console.error('An error occurred during form capture:', error);
  }
});
</script>
